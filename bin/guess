#!/usr/bin/env python3

import sys
import requests
import json

if len(sys.argv) != 2:
    print("Usage: guess <map_file.json>")
    sys.exit(1)

map_file = sys.argv[1]

try:
    with open(map_file, 'r') as f:
        map_data = json.load(f)
except FileNotFoundError:
    print(f"Error: File '{map_file}' not found")
    sys.exit(1)
except json.JSONDecodeError as e:
    print(f"Error: Invalid JSON in '{map_file}': {e}")
    sys.exit(1)

print(f"Submitting guess from {map_file}")

data = {
    "id": "awwaiid@thelackthereof.org zFPVkfKRKAgDUdmVr2Oi1A",
    "map": map_data
}

response = requests.post(
    "https://31pwr5t6ij.execute-api.eu-west-2.amazonaws.com/guess",
    headers={"Content-Type": "application/json"},
    json=data
)

print(f"Status: {response.status_code}")
print(response.text)